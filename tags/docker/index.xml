<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>docker on Ian's Blog</title><link>http://example.org/tags/docker/</link><description>Recent content in docker on Ian's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 27 Jun 2024 21:37:00 +0000</lastBuildDate><atom:link href="http://example.org/tags/docker/index.xml" rel="self" type="application/rss+xml"/><item><title>Podman</title><link>http://example.org/docs/programmer/cloudnative/%E5%AE%B9%E5%99%A8/note-of-podman/</link><pubDate>Thu, 27 Jun 2024 21:37:00 +0000</pubDate><guid>http://example.org/docs/programmer/cloudnative/%E5%AE%B9%E5%99%A8/note-of-podman/</guid><description>Podman # å¸¸ç”¨å‘½ä»¤ # 2. å¯åŠ¨å®¹å™¨å¹¶è¿›å…¥äº¤äº’æ¨¡å¼ # ä½ å¯ä»¥ä½¿ç”¨ docker run å‘½ä»¤å¯åŠ¨å®¹å™¨å¹¶è¿›å…¥å®¹å™¨çš„äº¤äº’å¼ shellã€‚è¿™æ ·ä½ å°±å¯ä»¥è¿›å…¥å®¹å™¨å†…éƒ¨è¿›è¡Œè°ƒè¯•ã€‚
å¤åˆ¶ä»£ç 
docker run -it --entrypoint /bin/bash nova-crawler:latest å‚æ•°è¯´æ˜ï¼š # -itï¼š-i è¡¨ç¤ºä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œ-t ç»™å®¹å™¨åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨ç»ˆç«¯ä¸å®¹å™¨äº¤äº’ã€‚ --entrypoint /bin/bashï¼šè¿™å°†è¦†ç›–å®¹å™¨çš„é»˜è®¤å…¥å£ç‚¹ï¼Œç›´æ¥å¯åŠ¨ä¸€ä¸ª bash shell ä»¥ä¾¿ä½ è¿›å…¥å®¹å™¨è¿›è¡Œè°ƒè¯•ã€‚ nova-crawler:latestï¼šä½ è¦è¿è¡Œçš„é•œåƒåç§°ã€‚ 3. å¯åŠ¨å®¹å™¨å¹¶è°ƒè¯•ç‰¹å®šå‘½ä»¤ # å¦‚æœä½ ä¸æƒ³è¿›å…¥å®¹å™¨çš„ shellï¼Œè€Œæ˜¯æƒ³ç›´æ¥æ‰§è¡Œè°ƒè¯•å‘½ä»¤ï¼ˆæ¯”å¦‚å¯åŠ¨åº”ç”¨å¹¶åœ¨è°ƒè¯•æ¨¡å¼ä¸‹è¿è¡Œï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
bash
å¤åˆ¶ä»£ç 
docker run -it --entrypoint /bin/bash nova-crawler:latest -c &amp;quot;your-debug-command&amp;quot;
4. æŸ¥çœ‹å®¹å™¨æ—¥å¿— # å¦‚æœä½ å¸Œæœ›åœ¨è°ƒè¯•æ—¶æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—è¾“å‡ºï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š
bash
å¤åˆ¶ä»£ç 
docker logs &amp;lt;container_id&amp;gt;
ä½ å¯ä»¥é€šè¿‡ docker ps æŸ¥æ‰¾è¿è¡Œçš„å®¹å™¨ IDï¼Œç„¶åæŸ¥çœ‹æ—¥å¿—è¾“å‡ºã€‚
5. è°ƒè¯•æ—¶æŒ‚è½½æœ¬åœ°ç›®å½•ï¼ˆå¯é€‰ï¼‰ # å¦‚æœä½ éœ€è¦è°ƒè¯•ä»£ç ï¼Œå¹¶ä¸”å¸Œæœ›æŒ‚è½½æœ¬åœ°ç›®å½•åˆ°å®¹å™¨ä¸­è¿›è¡Œå®æ—¶ç¼–è¾‘ï¼Œå¯ä»¥ä½¿ç”¨ -v å‚æ•°æ¥æŒ‚è½½æœ¬åœ°ç›®å½•ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ çš„æœ¬åœ°ä»£ç åœ¨ /path/to/your/code ç›®å½•ä¸‹ï¼š
bash
å¤åˆ¶ä»£ç </description></item><item><title>k8sæŠ€æœ¯åˆ†äº«</title><link>http://example.org/docs/programmer/cloudnative/k8s/k8s-%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/</link><pubDate>Thu, 07 Sep 2023 20:58:56 +0000</pubDate><guid>http://example.org/docs/programmer/cloudnative/k8s/k8s-%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/</guid><description>k8sæŠ€æœ¯åˆ†äº« # å·¥ä½œè´Ÿè½½èµ„æº # ä¸€ã€pod # 1. æ¦‚è¦ # å¯åˆ›å»ºç®¡ç†ã€æœ€å°çš„å¯éƒ¨ç½²è®¡ç®—å•å…ƒï¼Œæ˜¯å¯ä»¥åœ¨ä¸»æœºä¸Šè¿è¡Œçš„å®¹å™¨çš„é›†åˆ æˆ‘ä»¬çš„æœåŠ¡éƒ½åœ¨å…¶ä¸­è¿è¡Œã€‚å¦‚æˆ‘ä»¬çš„æœåŠ¡æ˜¯nginxï¼Œåˆ™æœ€å†…å±‚æ˜¯æˆ‘ä»¬çš„æœåŠ¡ nginxï¼Œè¿è¡Œåœ¨ container å®¹å™¨å½“ä¸­ã€‚container (å®¹å™¨) çš„æœ¬è´¨æ˜¯è¿›ç¨‹ï¼Œè€Œ pod æ˜¯ç®¡ç†è¿™ä¸€ç»„è¿›ç¨‹çš„èµ„æº æ‰€ä»¥podå¯è§†ä¸ºä¸€ä¸ªæä¸ºè½»é‡åŒ–ã€æ²¡æ’ç½‘çº¿çš„ç”µè„‘ï¼Œå¦‚æœæ‰€éœ€ä»»åŠ¡æ— éœ€äº¤äº’ï¼Œé‚£ä¹ˆç”¨podå°±å¾ˆåˆé€‚ã€‚ä¾‹å¦‚ç»™å®ƒæŒ‚è½½ä¸€ä¸ªæ–‡ä»¶æ¥è®­ç»ƒæ¨¡å‹ã€ç”ŸæˆæŠ¥è¡¨ï¼Œå¯ä»¥æ ¹æ®åœºæ™¯ä½¿ç”¨ Job æˆ–è€… CronJob æˆ–è€…å…¶å®ƒ å›¾ç¤ºå…³ç³»å¦‚ä¸‹ # ![[k8s-pod-insert.png]]
2. podç½‘ç»œ # å½“ç„¶ï¼Œpod å¯ä»¥ç®¡ç†å¤šä¸ª containerï¼Œåˆå› ä¸ºcontainer (å®¹å™¨) çš„æœ¬è´¨æ˜¯è¿›ç¨‹ï¼Œå¦‚æœæœ‰æœ¬åœ°ç½‘ç»œé€šä¿¡éœ€æ±‚(ä½¿ç”¨ localhost æˆ–è€… Socket æ–‡ä»¶è¿›è¡Œæœ¬åœ°é€šä¿¡)ï¼Œåœ¨è¿™äº›åœºæ™¯ä¸­ä½¿ç”¨ pod ç®¡ç†å¤šä¸ª container å°±éå¸¸çš„æ¨èã€‚
å¦‚ä¸‹å›¾å±•ç¤ºäº†Podç½‘ç»œæ‰€ä¾èµ–çš„3ä¸ªç½‘ç»œè®¾å¤‡
1. eth0æ˜¯èŠ‚ç‚¹ä¸»æœºä¸Šçš„ç½‘å¡ï¼Œæ”¯æŒè¯¥èŠ‚ç‚¹æµé‡å‡ºå…¥çš„è®¾å¤‡ã€ä¹Ÿæ˜¯æ”¯æŒé›†ç¾¤èŠ‚ç‚¹é—´IPå¯»å€å’Œäº’é€šçš„è®¾å¤‡ï¼›
2. docker0æ˜¯ä¸€ä¸ªè™šæ‹Ÿç½‘æ¡¥ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªè™šæ‹Ÿäº¤æ¢æœºï¼Œæ”¯æŒè¯¥èŠ‚ç‚¹ä¸Šçš„Podä¹‹é—´è¿›è¡ŒIPå¯»å€å’Œäº’é€šçš„è®¾å¤‡ï¼›
3. veth0åˆ™æ˜¯Pod1çš„è™šæ‹Ÿç½‘å¡ï¼Œæ”¯æŒè¯¥Podå†…å®¹å™¨äº’é€šå’Œå¯¹å¤–è®¿é—®çš„è™šæ‹Ÿè®¾å¤‡ï¼›
4. docker0ç½‘æ¡¥å’Œveth0ç½‘å¡ï¼Œéƒ½æ˜¯linuxæ”¯æŒå’Œåˆ›å»ºçš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼›
5. pauseå±äºç‰¹æ®Šå®¹å™¨ï¼Œå…¶è¿è¡Œçš„å”¯ä¸€ç›®çš„æ˜¯ä¸ºPodå»ºç«‹å…±äº«çš„veth0ç½‘ç»œæ¥å£
![[k8s-nginx-pod.png]]
äºŒã€deploymentã€StatefulSet # 1. æ¦‚è¦ # Deployment ä½¿å¾— Pod å’Œ ReplicaSet èƒ½å¤Ÿè¿›è¡Œå£°æ˜å¼æ›´æ–°
StatefulSet è¡¨ç¤ºä¸€ç»„å…·æœ‰ä¸€è‡´èº«ä»½çš„ Podï¼š
1. èº«ä»½å®šä¹‰ä¸ºï¼š</description></item><item><title>Docker</title><link>http://example.org/docs/programmer/cloudnative/note-of-docker/</link><pubDate>Thu, 16 Dec 2021 16:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/cloudnative/note-of-docker/</guid><description>Docker # æ•™ç¨‹æ‰‹å†Œ # å¥½ç”¨çš„ä½¿ç”¨æ•™ç¨‹
Install # ç•¥è¿‡~ ğŸ˜
æ‰“é•œåƒå’Œè·‘ # docker build -t server:v0 . -f server.dockerfile è·‘ # docker run -p 9080:80 --name server server:v0 æŒ‡å®šå¯åŠ¨å‘½ä»¤ # sudo docker run -it -p 9080:80 --name nova_server nova_server:v0 sh -c &amp;#34;echo hello&amp;#34; åŠ å…¥è‡ªå®šä¹‰ç½‘ç»œ # --network {{network name}} è¯¦è§ï¼š[[#Network]]
è·‘å‡ºé—®é¢˜-è¿›å…¥å®¹å™¨æ’æŸ¥ # sudo docker run -it -p 9080:80 --name nova_server nova_server:v0 sh -c &amp;#34;bash&amp;#34; ä½¿ç”¨-itè¿›å…¥å®¹å™¨æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤è¿›è¡Œè°ƒè¯•
å¯åŠ¨å…¨éƒ¨å®¹å™¨ # docker ps -a | grep &amp;#34;Exited&amp;#34; | awk &amp;#39;{print $1}&amp;#39; | xargs docker start Network # docker runæ—¶å®¹å™¨åŠ å…¥æ–¹æ³•-redisä¸ºä¾‹ åæœŸåŠ å…¥æ–¹å¼ åˆ›å»ºä¸€ä¸ªæ–°ç½‘ æ£€æµ‹ init_redis: docker run -p 6379:6379 \\ --network websafe-network \\ --name redislatest redis:latest --requirepass 3b21d032a7fd8eb51fa7bd8a2e812b78b7b3a36f join_network: docker network connect websafe-network mysql56 docker network connect websafe-network daemon-xxx init_network: docker network create websafe-network check_network: docker network inspect websafe-network docker network inspect websafe-network | findStr IPv4Address åˆ é™¤ # å¯è§†åŒ– # go install github.</description></item><item><title>Docker</title><link>http://example.org/docs/programmer/cloudnative/%E5%AE%B9%E5%99%A8/note-of-docker/</link><pubDate>Thu, 16 Dec 2021 16:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/cloudnative/%E5%AE%B9%E5%99%A8/note-of-docker/</guid><description>Docker # æ•™ç¨‹æ‰‹å†Œ # å¥½ç”¨çš„ä½¿ç”¨æ•™ç¨‹
Install # ç•¥è¿‡~ ğŸ˜
åŸºç¡€å‘½ä»¤ # æ‰“é•œåƒå’Œè·‘ # æ‰“ # docker build -t server:v0 . -f server.dockerfile dockerignore # å¦‚æœæ‚¨æƒ³åœ¨ Dockerfile ä¸­å°†å½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½å¤åˆ¶åˆ° Docker é•œåƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Dockerfile ä¸­çš„Â COPYÂ æŒ‡ä»¤ã€‚å…·ä½“çš„è¯­æ³•å¦‚ä¸‹ï¼š
COPY . /ç›®æ ‡è·¯å¾„/ å…¶ä¸­.Â è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ/ç›®æ ‡è·¯å¾„/Â è¡¨ç¤ºç›®æ ‡è·¯å¾„ï¼Œè¿™é‡Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ã€‚ è¿™å°†ä¼šå°†å½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­çš„Â /app/Â ç›®å½•ä¸‹ã€‚è¯·æ³¨æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½ä¼šè¢«å¤åˆ¶åˆ°é•œåƒä¸­ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚å¦‚æœæ‚¨ä¸æƒ³å¤åˆ¶æŸäº›æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œå¯ä»¥åœ¨è¿è¡ŒÂ COPYÂ æŒ‡ä»¤ä¹‹å‰é€šè¿‡Â .dockerignoreÂ æ–‡ä»¶æ¥æŒ‡å®šå¿½ç•¥çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
è·‘ # docker run -p 9080:80 --name server server:v0 æŒ‡å®šå¯åŠ¨å‘½ä»¤ # sudo docker run -it -p 9080:80 --name nova_server nova_server:v0 sh -c &amp;#34;echo hello&amp;#34; åŠ å…¥è‡ªå®šä¹‰ç½‘ç»œ # --network {{network name}} è¯¦è§ï¼š[[#Network]]</description></item></channel></rss>