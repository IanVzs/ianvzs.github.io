<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>python on Ian's Blog</title><link>http://example.org/tags/python/</link><description>Recent content in python on Ian's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 24 Mar 2025 00:00:00 +0000</lastBuildDate><atom:link href="http://example.org/tags/python/index.xml" rel="self" type="application/rss+xml"/><item><title>PythonåŒ…ç®¡ç†</title><link>http://example.org/docs/programmer/langs/python/python%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/</link><pubDate>Mon, 24 Mar 2025 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/langs/python/python%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86/</guid><description>[[Rye ç®€å•ä½¿ç”¨æŒ‡å—]] # Rye æ˜¯ä¸€ä¸ªç”± Flask ä½œè€… Armin Ronacher å¼€å‘çš„ Python ç‰ˆæœ¬å’Œä¾èµ–ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äº Pyenv + Poetry çš„ç»„åˆã€‚
å®‰è£… Rye # curl --proto &amp;#39;=https&amp;#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh # å®‰è£…cargo cargo install --git https://github.com/mitsuhiko/rye rye # å®‰è£…rye cargoçš„ .bashrc ç›¸å…³:
ç•¥ç•¥ç•¥ç•¥ç•¥ç•¥ . &amp;#34;$HOME/.cargo/env&amp;#34; åŸºæœ¬å‘½ä»¤ # åˆå§‹åŒ–æ–°é¡¹ç›® # rye init my_project cd my_project æŒ‡å®š Python ç‰ˆæœ¬ # rye pin 3.9.10 # æŒ‡å®šä½¿ç”¨ Python 3.9.10 æ·»åŠ ä¾èµ– # rye add flask==2.3.2 rye add black --dev # æ·»åŠ å¼€å‘ä¾èµ– åŒæ­¥ä¾èµ– # rye sync è¿è¡Œé¡¹ç›® # rye run python main.</description></item><item><title>Pythonç¼–ç è§„èŒƒ</title><link>http://example.org/docs/programmer/langs/python/%E8%A7%84%E8%8C%83/</link><pubDate>Wed, 28 Aug 2024 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/langs/python/%E8%A7%84%E8%8C%83/</guid><description> å‡½æ•°è¿”å›å€¼å®šä¹‰ # å¤šä¸ªè¿”å›å€¼ - Tuple # async def function_name(package_name: str) -&amp;gt; Tuple[ParamsPushLvl2Pool, bool]: pass æ”¯æŒä¼ å…¥å¤šç±»å‹ - Union # ex: Union[ExpiryT, None] = None, è¿­ä»£ # def _yield_offer_info(_session, from_days_ago: int) -&amp;gt; Iterator[Offer]:</description></item><item><title>Python Redis å®¢æˆ·ç«¯</title><link>http://example.org/docs/programmer/cloudnative/redis/python-redis-%E5%AE%A2%E6%88%B7%E7%AB%AF/</link><pubDate>Thu, 13 Jun 2024 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/cloudnative/redis/python-redis-%E5%AE%A2%E6%88%B7%E7%AB%AF/</guid><description>å¼‚æ­¥è°ƒç”¨æ—¶è‡ªåŠ¨å…³é—­ # å½“äº‹ä»¶å¾ªç¯æ­£åœ¨è¿è¡Œæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªä»»åŠ¡æ¥å…³é—­ redis è¿æ¥ï¼Œè€Œä¸ä¼šé˜»å¡äº‹ä»¶å¾ªç¯ã€‚å¦‚æœäº‹ä»¶å¾ªç¯æ²¡æœ‰è¿è¡Œï¼Œå°±å¯ä»¥åƒä¹‹å‰ä¸€æ ·è°ƒç”¨ run_until_completeã€‚
async def close_redis(self): if self.redis: await self.redis.close() def __del__(self): loop = asyncio.get_event_loop() if loop.is_running(): asyncio.create_task(self.close_redis()) else: loop.run_until_complete(self.close_redis()) æ•°æ®è¿ç§»(hashæ•°æ®) # è„šæœ¬ # import os import json import redis import argparse from loguru import logger home_path = os.environ.get(&amp;#39;HOME&amp;#39;) parser = argparse.ArgumentParser(description=&amp;#39;Copy Reten Config&amp;#39;) parser.add_argument(&amp;#39;--mode&amp;#39;, help=&amp;#39;Pull or Push data from Redis&amp;#39;) parser.add_argument(&amp;#39;-ds&amp;#39;, &amp;#39;--datasource&amp;#39;, help=&amp;#39;retens or events config data from Redis&amp;#39;) args = parser.parse_args() source_redis = redis.StrictRedis(host=&amp;#39;redis-product.com&amp;#39;, port=6379, db=0) def scan_keys_with_pattern(pattern): # åˆå§‹æ¸¸æ ‡ cursor = &amp;#39;0&amp;#39; count_group = 0 while True: # ä½¿ç”¨ SCAN å‘½ä»¤è¿›è¡Œè¿­ä»£ cursor, keys = source_redis.</description></item><item><title>Python å¤šçº¿ç¨‹å¤šè¿›ç¨‹</title><link>http://example.org/docs/programmer/langs/python/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%A4%9A%E8%BF%9B%E7%A8%8B/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/langs/python/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%A4%9A%E8%BF%9B%E7%A8%8B/</guid><description>ä¸€ä¸ªåç¨‹ç¤ºä¾‹ï¼š import asyncio async def my_coroutine(): # è¿™é‡Œæ˜¯åç¨‹çš„ä»£ç  await asyncio.sleep(1) print(&amp;#34;Coroutine is done&amp;#34;) async def main(): # åˆ›å»ºä¸€ä¸ªä»»åŠ¡å¯¹è±¡ task = asyncio.create_task(my_coroutine()) # ç­‰å¾…ä»»åŠ¡å®Œæˆ await task # è¿è¡Œä¸»åç¨‹ asyncio.run(main()) ä¸€ä¸ªçº¿ç¨‹ç¤ºä¾‹ï¼š import threading # å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨çº¿ç¨‹ä¸­æ‰§è¡Œ def thread_function(name): print(f&amp;#34;Thread {name}: starting&amp;#34;) # åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›æ“ä½œ print(f&amp;#34;Thread {name}: finishing&amp;#34;) # åˆ›å»ºçº¿ç¨‹çš„å®ä¾‹ thread = threading.Thread(target=thread_function, args=(1,)) # å¯åŠ¨çº¿ç¨‹ thread.start() # ç­‰å¾…çº¿ç¨‹ç»“æŸ thread.join() print(&amp;#34;Main thread is done&amp;#34;) ä¸€ä¸ªloop tipï¼š self.loop = asyncio.get_event_loop() self.queue.set_loop(loop=self.loop) await self.af.set_loop(loop=self.loop) await self.adjust.set_loop(loop=self.loop) ä¸ºä»€ä¹ˆè¿™é‡Œä½¿ç”¨åŒä¸€ä¸ªloop ?</description></item><item><title>Python å¸¸ç”¨åº“</title><link>http://example.org/docs/programmer/langs/python/notespython/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/langs/python/notespython/</guid><description>pydantic # æ¥è‡ªç±» # from pydantic import BaseModel class User(BaseModel): name: str age: int class Config: from_attributes = True # å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ™®é€šçš„ Python å¯¹è±¡ï¼Œå®ƒå…·æœ‰ä¸æ¨¡å‹å­—æ®µç›¸åŒçš„å±æ€§å class OrdinaryObject: def __init__(self, name, age): self.name = name self.age = age # åˆ›å»ºä¸€ä¸ª OrdinaryObject å®ä¾‹ ordinary_object = OrdinaryObject(name=&amp;#39;Alice&amp;#39;, age=30) # ç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥å°† ordinary_object ä¼ é€’ç»™ User æ¨¡å‹çš„æ„é€ å‡½æ•° user_model = User(ordinary_object) # è¾“å‡ºæ¨¡å‹çš„å­—æ®µå€¼ print(user_model.dict()) # è¾“å‡º: {&amp;#39;name&amp;#39;: &amp;#39;Alice&amp;#39;, &amp;#39;age&amp;#39;: 30} è‡ªå®šä¹‰å­—æ®µ # class User(BaseModel): id: int is_active: bool wx_infos: List[str] = [] class Config: arbitrary_types_allowed = True # å…è®¸ä»»æ„ç±»å‹ Tupleå®šä¹‰é—®é¢˜ # from typing import List, Tuple class Task(BaseModel): launch_count_today: int launch_groups: List[Tuple[str, .</description></item><item><title>Python ç¬”è®°</title><link>http://example.org/docs/programmer/langs/python/notespython/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/langs/python/notespython/</guid><description>pip cache ç›®å½• # echo $PIP_CACHE_DIR ç‰¹æ®Šå‡½æ•°è°ƒç”¨ property # ä½¿ç”¨å­—æ®µçš„æ–¹å¼è°ƒç”¨å‡½æ•°
from datetime import datetime from pydantic import BaseModel class InstallCountInfo(BaseModel): count: int total: int @property def done_rate(self): return round(self.count / self.total, 4) class InstallCount(BaseModel): pass_day: int install_day: datetime info: InstallCountInfo å½»åº•æ‘†è„±to_dictå’Œfrom_dict # ä½¿ç”¨ pydantic # BaseModelç±»å‹æ”¯æŒ:
b = BattleAxiePositionInfo.parse_obj(DICT_DATA) b.json() b.dict() parse_file parse_raw from pydantic import BaseModel class PositionInfo(BaseModel): error: int = -1 # æ”¶é›†é”™è¯¯ none: int = 0 # è¿˜æ²¡å¼€å§‹ clicked: int = 1 # åœ¨client èµ‹æ­¤å€¼ done: int = 2 # åœ¨server èµ‹æ­¤å€¼ xy: List[int] = [0, 0] status: int = 0 # clicked or done or none or error class BattleAxiePositionInfo(BaseModel): our: List[PositionInfo] = [PositionInfo(), PositionInfo(), PositionInfo(), PositionInfo(), PositionInfo(), PositionInfo()] enemy: List[PositionInfo] = [PositionInfo(), PositionInfo(), PositionInfo(), PositionInfo(), PositionInfo(), PositionInfo()] pp = BattleAxiePositionInfo() print(f&amp;#34;pp json: {pp.</description></item><item><title>Pyå°å·¥å…·å’ŒåŠŸèƒ½æ€§æ–¹æ³•</title><link>http://example.org/docs/programmer/langs/python/py%E5%B0%8F%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8A%9F%E8%83%BD%E6%80%A7%E6%96%B9%E6%B3%95/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/langs/python/py%E5%B0%8F%E5%B7%A5%E5%85%B7%E5%92%8C%E5%8A%9F%E8%83%BD%E6%80%A7%E6%96%B9%E6%B3%95/</guid><description>author:Ian
é‚®ä»¶ # ä¸­æ–‡é™„ä»¶ # å‘é€é‚®ä»¶æ—¶æºå¸¦é™„ä»¶ ä¸­æ–‡åç§°é™„ä»¶
def send_email_week_report(htm, recipients, copys, file_name, file_path): port = 465 # str_today = datetime.now().strftime(&amp;#34;%Y-%m-%d %H:%M:%S&amp;#34;) str_today = datetime.now().strftime(&amp;#34;%Y-%m-%d&amp;#34;) mail_host = &amp;#34;mail.{demo}.com&amp;#34; mail_user = &amp;#34;{user name}&amp;#34; mail_pass = &amp;#34;{passwd}&amp;#34; sender = &amp;#39;{name}@{demo}.com&amp;#39; mail_from = &amp;#34;{name} &amp;lt;{name}@{demo}.com&amp;gt;&amp;#34; msg_Bcc = &amp;#39;{name}@{demo}.com&amp;#39; subject = f&amp;#34;{title}-{str_today}&amp;#34; # æ ‡é¢˜ msg = MIMEMultipart() msg.attach(MIMEText(htm, &amp;#39;html&amp;#39;, &amp;#39;utf-8&amp;#39;)) # è¿™é‡Œå¯ä»¥ä¼ htmlå†…å®¹ ä¹Ÿå¯ä»¥ä¼ æ™®é€šæ–‡å­— # åˆ›å»ºé™„ä»¶ with open(file_path, &amp;#39;rb&amp;#39;) as attachment: part = MIMEBase(&amp;#39;application&amp;#39;, &amp;#39;octet-stream&amp;#39;) part.set_payload(attachment.read()) encoders.</description></item><item><title>å›¾å½¢åŒ–ç•Œé¢ ï¼ˆPython Guiï¼‰</title><link>http://example.org/docs/programmer/gui/notespython/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/gui/notespython/</guid><description>author:Ian
Python GUI ğŸ’½ # pynput # åœ¨ pynput æ¨¡å—ä¸­ï¼ŒWiné”®è¢«ç§°ä¸ºâ€œç‰¹æ®Šé”®â€ï¼ˆSpecial keysï¼‰ï¼Œéœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„åç§°æ¥è¡¨ç¤ºã€‚
ä»¥ä¸‹æ˜¯å¯ä»¥ä½¿ç”¨çš„ç‰¹æ®Šé”®åç§°åˆ—è¡¨ï¼š
https://pynput.readthedocs.io/en/latest/keyboard.html?highlight=%3Ccmd%3E#controlling-the-keyboard å› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦åœ¨çƒ­é”®è®¾ç½®ä¸­ä½¿ç”¨ Winé”®+ç©ºæ ¼ è¿™ä¸ªçƒ­é”®ï¼Œå¯ä»¥å°†å®ƒä»¬åˆ†åˆ«æ›¿æ¢ä¸º cmd å’Œ spaceï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
from pynput import keyboard def on_activate(): print(&amp;#39;Hotkey activated&amp;#39;) def on_exit(): print(&amp;#39;Hotkey exited&amp;#39;) return False with keyboard.GlobalHotKeys({&amp;#39;&amp;lt;cmd&amp;gt;+&amp;lt;space&amp;gt;&amp;#39;: on_activate}) as h: h.join(on_exit)``` åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ &amp;lt;cmd&amp;gt;+&amp;lt;space&amp;gt; æ¥è¡¨ç¤º Winé”®+ç©ºæ ¼ çƒ­é”®ï¼Œå› ä¸ºåœ¨Macä¸­ï¼ŒCommandé”®ï¼ˆcmdï¼‰å¯ä»¥èµ·åˆ°ç±»ä¼¼äºWiné”®çš„ä½œç”¨ã€‚ ## PyQt ![qt](https://tse4-mm.cn.bing.net/th/id/OIP.J4_Nqrcc0x7slHHUFwKLSQHaI6?pid=ImgDet&amp;amp;rs=1 &amp;#34;tmp&amp;#34;) å®˜æ–¹è¯´æ˜æ–‡æ¡£ï¼š&amp;lt;http://pyqt.sourceforge.net/Docs/PyQt4/index.html&amp;gt; ç…§ä¾‹ï¼Œå…ˆè´´ç½‘å€ï¼š &amp;lt;http://www.qaulau.com/books/PyQt4_Tutorial/index.html&amp;gt; ## ç”»ç•Œé¢ #PyQt4ä½¿ç”¨designer.exe import os for root, dirs, files in os.walk(&amp;#39;.&amp;#39;): for file in files: if file.endswith(&amp;#39;.ui&amp;#39;): os.system(&amp;#39;pyuic4 -o ui_%s.</description></item><item><title>æœºå™¨å­¦ä¹ åº“</title><link>http://example.org/docs/programmer/ml/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E5%BA%93%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/ml/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%B8%B8%E7%94%A8%E5%BA%93%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</guid><description>Python æœºå™¨å­¦ä¹ åº“ ğŸ‘½ # Plotly # ä¸matplotlib éƒ½æ˜¯ç»˜å›¾å·¥å…·ï¼Œä¸è¿‡æ•ˆæœç‚«ä¸€äº›ï¼Œæˆ‘ä¹Ÿæ²¡ç”»è¿‡ï¼Œæ‰€ä»¥åªæ”¾é“¾æ¥ï¼Œä¸æ”¾å®ä¾‹äº† Plotly Python Library : https://plot.ly/python/
matplotlib # import matplotlib.pyplot as plt å‚æ•°ç­‰å¤ªå¤šï¼Œé“¾æ¥æœ€å¯é  # pyplotå‚æ•°
è¿˜æ˜¯ç²˜ä¸€äº›å¸¸ç”¨çš„ï¼š marker å±æ€§ï¼ˆä¸‹é¢å†™åœ¨åˆ†å·é‡Œå‘¦ï¼‰ o . v ^ &amp;lt; &amp;gt; 1 2 3 4 8 s p * h H + x D d | _ ä¹‹ç±»
ç”»å‡ºä¸€äº›â€œèŠ±å„¿â€
ç»˜å›¾ # plt.plot(x, y) # åœ¨yä¹‹åå¯æ·»åŠ å‚æ•°ï¼Œä¾‹å¦‚å¸¸ç”¨çš„label = â€˜IamLabelâ€™ä¹‹ç±» # çº¿çš„æ ·å¼ã€é¢œè‰² ï¼šb: blue g: green r: red c: cyan m: magenta y: yellow k: black w: white '-' : solid , '--' : dashed, '-.</description></item><item><title>è§£å†³é—®é¢˜</title><link>http://example.org/docs/programmer/langs/python/notespython/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>http://example.org/docs/programmer/langs/python/notespython/</guid><description>PiP Not Found Issue # ä½¿ç”¨pipå®‰è£…æŸåŒ…æ—¶ï¼Œ æç¤ºè®©æ›´æ–°ï¼Œ æŒ‰æç¤ºæ“ä½œæ›´æ–°æ²¡æ•ˆæœæ²¡ååº”å†ç”¨å°±æç¤ºModuleNotFoundError: No module named 'pip' (Ë‰â–½Ë‰ï¼›)&amp;hellip;
ModuleNotFoundError: No module named &amp;lsquo;pip&amp;rsquo; # å‡çº§PiPæ—¶å‡ºç°é—®é¢˜å¯ç”±ä¸‹æ–¹å‘½ä»¤ä¿®å¤ # python -m ensurepip python -m pip install --upgrade pip SSLæ ¡éªŒ # å®‰è£…EasyOCRæ—¶, reader = easyocr.Reader(['ch_sim','en']) ä¸‹è½½åˆ°æ¥è¿‘90,ç»“æœæŠ¥é”™äº†&amp;hellip;. ä¼°è®¡æ˜¯SSLé—®é¢˜åŠ å…¥ä»¥ä¸‹ä¸¤æ¡,ä¸çŸ¥å¦‚ä½•.
import ssl ssl._create_default_https_context = ssl._create_unverified_context from http.client To revert to the previous, unverified, behavior ssl._create_unverified_context() can be passed to the context parameter.
ä½¿ç”¨å›½å†…é•œåƒä¸‹è½½Python # pip install --index https://pypi.mirrors.ustc.edu.cn/simple/ dlib(numpyç­‰åŒ…å) # ä¸€é”®æ›´æ–°pip åŒ…èµ„æº(åˆ©ç”¨ç®¡é“grepä¼ è¾“æŸ¥è¯¢åˆ°çš„éœ€è¦æ›´æ–°åŒ…åï¼Œä¼ è¾“åˆ°installå‘½ä»¤) pip3 freeze --local | grep -v &amp;#39;^\-e&amp;#39; | cut -d = -f 1 | xargs -n1 pip3 install -U # æƒé™ä¸å¤Ÿçš„è¯å°±åœ¨`pip3 install` ä¹‹å‰åŠ `sudo`åæ­£æˆ‘ä¸ä¹ æƒ¯ç”¨`root` å®‰è£…é”™è¯¯ï¼Ÿ # å±…ç„¶æœ‰pip3 install XXçš„é”™è¯¯â€¦è¿™ä¹Ÿæ˜¯å› ä¸ºæœ‰æ—§ç‰ˆpip3å­˜ç•™ã€‚éœ€è¦</description></item></channel></rss>